
# Secret Santa Bot — MVP (aiogram 3.x + FastAPI + Render)

Готовый минимально рабочий бот: FSM, жеребьёвка, отмена последней жеребьёвки, анонимные сообщения и уборка бот-сообщений (не скапливаются).

## Запуск локально
1) Python 3.11+
2) `pip install -r requirements.txt`
3) Применить `database.sql` в вашей БД PostgreSQL
4) Создать `.env` по `.env.example`
5) `uvicorn app:app --reload`

## Деплой на Render
- Подключить репозиторий как Web Service
- Добавить переменные окружения (BOT_TOKEN, DATABASE_URL, BASE_URL, WEBHOOK_SECRET)
- Старт: `uvicorn app:app --host 0.0.0.0 --port $PORT`

## Что есть
- /start, /create, /join <id>, deep-link `/start join_<room_id>`
- FSM для создания комнаты и вступления (с чисткой бот-сообщений)
- Жеребьёвка без self и 2-циклов; таблица версий `draws`
- ↩️ Отмена последней жеребьёвки (удаление последнего draw)
- Личные уведомления «кому даришь»
- Анонимные сообщения получателю
- Inline-меню комнаты

> Ограничение Telegram: в личке бот не может удалять сообщения пользователя. Мы удаляем только свои временные сообщения (вопросы), поэтому «мусор» от бота не копится.
